/**
 * name: @tresjs/core
 * version: v3.6.1
 * (c) 2024
 * description: Declarative ThreeJS using Vue Components
 * author: Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)
 */
(function(w,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("vue"),require("three"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","three","@vueuse/core"],l):(w=typeof globalThis<"u"?globalThis:w||self,l(w.tres={},w.Vue,w.Three,w.VueUseCore))})(this,function(w,l,M,v){"use strict";function ie(e){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const t in e)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(a,t,r.get?r:{enumerable:!0,get:()=>e[t]})}}return a.default=e,Object.freeze(a)}const le=ie(M),ue={name:"@tresjs/core",type:"module",version:"3.6.1",packageManager:"pnpm@8.10.2",description:"Declarative ThreeJS using Vue Components",author:"Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",license:"MIT",keywords:["vue","3d","threejs","three","threejs-vue"],sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",require:"./dist/tres.umd.cjs",import:"./dist/tres.js"},"./components":{types:"./dist/components/index.d.ts"},"./composables":{types:"./dist/composables/index.d.ts"},"./types":{types:"./dist/types/index.d.ts"},"./utils":{types:"./dist/utils/index.d.ts"},"./*":"./*"},main:"./dist/tres.js",module:"./dist/tres.js",types:"./dist/index.d.ts",files:["dist","*.d.ts"],publishConfig:{access:"public"},scripts:{dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui",release:"release-it",coverage:"vitest run --coverage",lint:"eslint . --ext .js,.jsx,.ts,.tsx,.vue","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts"},peerDependencies:{three:">=0.133",vue:">=3.3"},dependencies:{"@alvarosabu/utils":"^3.1.1","@vueuse/core":"^10.7.0"},devDependencies:{"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.9.0","@tresjs/cientos":"3.6.0","@tresjs/eslint-config-vue":"^0.2.1","@types/three":"^0.159.0","@typescript-eslint/eslint-plugin":"^6.14.0","@typescript-eslint/parser":"^6.14.0","@vitejs/plugin-vue":"^4.5.2","@vitest/coverage-c8":"^0.33.0","@vitest/ui":"^1.0.4","@vue/test-utils":"^2.4.3",eslint:"^8.55.0","eslint-plugin-vue":"^9.19.2",esno:"^4.0.0",gsap:"^3.12.3",jsdom:"^23.0.1",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.1","release-it":"^17.0.1","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.11.0",three:"^0.159.0",unocss:"^0.58.0",unplugin:"^1.5.1","unplugin-vue-components":"^0.26.0",vite:"^5.0.8","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.6.4","vite-plugin-inspect":"^0.8.1","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.0.0-rc.31",vitest:"^1.0.4",vue:"^3.3.11","vue-demi":"^0.14.6"}},G=({sizes:e,scene:a})=>{const t=l.ref([]),r=l.computed(()=>t.value[0]),n=(o,u=!1)=>{t.value.some(({uuid:f})=>f===o.uuid)||(u?c(o):t.value.push(o))},s=o=>{t.value=t.value.filter(({uuid:u})=>u!==o.uuid)},c=o=>{const u=o instanceof M.Camera?o:t.value.find(m=>m.uuid===o);if(!u)return;const f=t.value.filter(({uuid:m})=>m!==u.uuid);t.value=[u,...f]};return l.watchEffect(()=>{e.aspectRatio.value&&t.value.forEach(o=>{o instanceof M.PerspectiveCamera&&(o.aspect=e.aspectRatio.value),(o instanceof M.PerspectiveCamera||o instanceof M.OrthographicCamera)&&o.updateProjectionMatrix()})}),a.userData.tres__registerCamera=n,a.userData.tres__deregisterCamera=s,l.onUnmounted(()=>{t.value=[]}),{camera:r,cameras:t,registerCamera:n,deregisterCamera:s,setCameraActive:c}},W=v.createEventHook(),q=v.createEventHook(),R=v.createEventHook(),E=new M.Clock;let O=0,B=0;const{pause:ce,resume:fe,isActive:de}=v.useRafFn(()=>{W.trigger({delta:O,elapsed:B,clock:E}),q.trigger({delta:O,elapsed:B,clock:E}),R.trigger({delta:O,elapsed:B,clock:E})},{immediate:!1});R.on(()=>{O=E.getDelta(),B=E.getElapsedTime()});const $=()=>({onBeforeLoop:W.on,onLoop:q.on,onAfterLoop:R.on,pause:ce,resume:fe,isActive:de}),pe=!0,U="[TresJS ▲ ■ ●] ";function L(){function e(r,n){console.error(`${U} ${r}`,n||"")}function a(r){console.warn(`${U} ${r}`)}function t(r,n){}return{logError:e,logWarning:a,logMessage:t}}function me(e){return typeof e=="number"?[e,e,e]:e instanceof M.Vector3?[e.x,e.y,e.z]:e}function Y(e){return e instanceof M.Color?e:Array.isArray(e)?new M.Color(...e):new M.Color(e)}const H=(e,a)=>{for(const t of Object.keys(a))a[t]instanceof Object&&Object.assign(a[t],H(e[t],a[t]));return Object.assign(e||{},a),e},ve=ge("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot");function J(e){return e&&e.nodeType===1}function x(e){return e.replace(/-([a-z])/g,(a,t)=>t.toUpperCase())}function ge(e,a){const t=Object.create(null),r=e.split(",");for(let n=0;n<r.length;n++)t[r[n]]=!0;return a?n=>!!t[n.toLowerCase()]:n=>!!t[n]}const ye=(e,a)=>{const t=new Set,r=[];for(const n of e){const s=a(n);t.has(s)||(t.add(s),r.push(n))}return r},K=(e,a)=>{if(!a)return;const t=Array.isArray(a)?a:a.match(/([^[.\]])+/g);return t==null?void 0:t.reduce((r,n)=>r&&r[n],e)},he=(e,a,t)=>{const r=Array.isArray(a)?a:a.match(/([^[.\]])+/g);r&&r.reduce((n,s,c)=>(n[s]===void 0&&(n[s]={}),c===r.length-1&&(n[s]=t),n[s]),e)};function X(e,a){if(J(e)&&J(a)){const n=e.attributes,s=a.attributes;return n.length!==s.length?!1:Array.from(n).every(({name:c,value:o})=>a.getAttribute(c)===o)}if(e===a)return!0;if(e===null||typeof e!="object"||a===null||typeof a!="object")return!1;const t=Object.keys(e),r=Object.keys(a);if(t.length!==r.length)return!1;for(const n of t)if(!r.includes(n)||!X(e[n],a[n]))return!1;return!0}function we(e,a){if(!Array.isArray(e)||!Array.isArray(a)||e.length!==a.length)return!1;for(let t=0;t<e.length;t++)if(!X(e[t],a[t]))return!1;return!0}const be=Array.isArray,Ce=Number.parseInt(M.REVISION.replace("dev","")),T={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:M.SRGBColorSpace,toneMapping:M.ACESFilmicToneMapping,toneMappingExposure:3,shadowMap:{enabled:!0,type:M.PCFSoftShadowMap}}};function Q({scene:e,canvas:a,options:t,disableRender:r,contextParts:{sizes:n,camera:s}}){const c=l.computed(()=>({alpha:v.toValue(t.alpha),depth:v.toValue(t.depth),canvas:v.unrefElement(a),context:v.toValue(t.context),stencil:v.toValue(t.stencil),antialias:v.toValue(t.antialias)===void 0?!0:v.toValue(t.antialias),precision:v.toValue(t.precision),powerPreference:v.toValue(t.powerPreference),premultipliedAlpha:v.toValue(t.premultipliedAlpha),preserveDrawingBuffer:v.toValue(t.preserveDrawingBuffer),logarithmicDepthBuffer:v.toValue(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:v.toValue(t.failIfMajorPerformanceCaveat)})),o=l.shallowRef(new M.WebGLRenderer(c.value));l.watch(c,()=>{o.value.dispose(),o.value=new M.WebGLRenderer(c.value)}),l.watchEffect(()=>{o.value.setSize(n.width.value,n.height.value)});const{pixelRatio:u}=v.useDevicePixelRatio();l.watchEffect(()=>{o.value.setPixelRatio(u.value)});const{logError:f}=L(),d=(()=>{const p=new M.WebGLRenderer,b={shadowMap:{enabled:p.shadowMap.enabled,type:p.shadowMap.type},toneMapping:p.toneMapping,toneMappingExposure:p.toneMappingExposure,outputColorSpace:p.outputColorSpace};return p.dispose(),b})();l.watchEffect(()=>{const p=v.toValue(t.preset);p&&(p in T||f(`Renderer Preset must be one of these: ${Object.keys(T).join(", ")}`),H(o.value,T[p]));const b=(D,S)=>{const P=v.toValue(D),j=()=>{if(p)return K(T[p],S)};if(P!==void 0)return P;const h=j();return h!==void 0?h:K(d,S)},k=(D,S)=>he(o.value,S,b(D,S));k(t.shadows,"shadowMap.enabled"),k(t.toneMapping,"toneMapping"),k(t.shadowMapType,"shadowMap.type"),Ce<150&&k(!t.useLegacyLights,"physicallyCorrectLights"),k(t.outputColorSpace,"outputColorSpace"),k(t.toneMappingExposure,"toneMappingExposure");const _=b(t.clearColor,"clearColor");_&&o.value.setClearColor(_?Y(_):new M.Color(0))});const{pause:i,resume:y,onLoop:C}=$();return C(()=>{s.value&&!v.toValue(r)&&o.value.render(e,s.value)}),y(),l.onUnmounted(()=>{i(),o.value.dispose(),o.value.forceContextLoss()}),{renderer:o}}const Z=e=>typeof e=="function",_e=e=>!!e&&e.constructor===Array;function ee(e){const a={nodes:{},materials:{}};return e&&e.traverse(t=>{t.name&&(a.nodes[t.name]=t),t.material&&!a.materials[t.material.name]&&(a.materials[t.material.name]=t.material)}),a}async function Me(e,a,t,r,n){const{logError:s}=L(),c=new e;n&&n(c),t&&t(c);const u=(Array.isArray(a)?a:[a]).map(f=>new Promise((m,d)=>{c.load(f,i=>{i.scene&&Object.assign(i,ee(i.scene)),m(i)},r,i=>d(s("[useLoader] - Failed to load resource",i)))}));return _e(a)?await Promise.all(u):await u[0]}async function Pe(e){const a=new M.LoadingManager,t=new M.TextureLoader(a),r=n=>new Promise((s,c)=>{t.load(n,o=>s(o),()=>null,()=>{c(new Error("[useTextures] - Failed to load texture"))})});if(be(e)){const n=await Promise.all(e.map(s=>r(s)));return e.length>1?n:n[0]}else{const{map:n,displacementMap:s,normalMap:c,roughnessMap:o,metalnessMap:u,aoMap:f,alphaMap:m,matcap:d}=e;return{map:n?await r(n):null,displacementMap:s?await r(s):null,normalMap:c?await r(c):null,roughnessMap:o?await r(o):null,metalnessMap:u?await r(u):null,aoMap:f?await r(f):null,alphaMap:m?await r(m):null,matcap:d?await r(d):null}}}const te=(e,{renderer:a,camera:t,raycaster:r})=>{const n=l.computed(()=>a.value.domElement),{x:s,y:c}=v.usePointer({target:n}),{width:o,height:u,top:f,left:m}=v.useElementBounding(n),d=({x:h,y:A})=>{if(n.value)return{x:(h-m.value)/o.value*2-1,y:-((A-f.value)/u.value)*2+1}},i=({x:h,y:A})=>{if(t.value)return r.value.setFromCamera(new M.Vector2(h,A),t.value),r.value.intersectObjects(e.value,!1)},y=h=>{const A=d({x:(h==null?void 0:h.clientX)??s.value,y:(h==null?void 0:h.clientY)??c.value});return A?i(A)||[]:[]},C=l.computed(()=>y()),p=v.createEventHook(),b=v.createEventHook(),k=(h,A)=>{h.trigger({event:A,intersects:y(A)})},_=h=>{k(b,h)};let D;const S=h=>{var A;D=(A=y(h)[0])==null?void 0:A.object},P=h=>{var A;h instanceof PointerEvent&&D===((A=y(h)[0])==null?void 0:A.object)&&k(p,h)},j=h=>b.trigger({event:h,intersects:[]});return n.value.addEventListener("pointerup",P),n.value.addEventListener("pointerdown",S),n.value.addEventListener("pointermove",_),n.value.addEventListener("pointerleave",j),l.onUnmounted(()=>{n!=null&&n.value&&(n.value.removeEventListener("pointerup",P),n.value.removeEventListener("pointerdown",S),n.value.removeEventListener("pointermove",_),n.value.removeEventListener("pointerleave",j))}),{intersects:C,onClick:h=>p.on(h).off,onPointerMove:h=>b.on(h).off}};function ke(){const{logWarning:e}=L();function a(s,c,o){let u=null;return s.traverse(f=>{f[c]===o&&(u=f)}),u||e(`Child with ${c} '${o}' not found.`),u}function t(s,c,o){const u=[];return s.traverse(f=>{f[c].includes(o)&&u.push(f)}),u.length||e(`Children with ${c} '${o}' not found.`),u}function r(s,c){return a(s,"name",c)}function n(s,c){return t(s,"name",c)}return{seek:a,seekByName:r,seekAll:t,seekAllByName:n}}const re=({scene:e,contextParts:a})=>{const t=l.reactive({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),r=l.ref(new Set),n=i=>{r.value.add(i)},s=i=>{r.value.delete(i)},c=i=>{Object.values(t).forEach(y=>y.delete(i)),s(i)},o=i=>{const{onClick:y,onPointerMove:C,onPointerEnter:p,onPointerLeave:b}=i;y&&t.click.set(i,y),C&&t.pointerMove.set(i,C),p&&t.pointerEnter.set(i,p),b&&t.pointerLeave.set(i,b)};e.userData.tres__registerAtPointerEventHandler=o,e.userData.tres__deregisterAtPointerEventHandler=c,e.userData.tres__registerBlockingObjectAtPointerEventHandler=n,e.userData.tres__deregisterBlockingObjectAtPointerEventHandler=s;const u=l.computed(()=>ye([...Array.from(r.value),...Object.values(t).map(i=>Array.from(i.keys())).flat()],({uuid:i})=>i)),{onClick:f,onPointerMove:m}=te(u,a);f(({intersects:i,event:y})=>{var C;i.length&&((C=t.click.get(i[0].object))==null||C(i[0],y))});let d;return m(({intersects:i,event:y})=>{var _,D,S,P;const C=(_=i==null?void 0:i[0])==null?void 0:_.object,{pointerLeave:p,pointerEnter:b,pointerMove:k}=t;d&&d!==C&&((D=p.get(d))==null||D(d,y)),C&&(d!==C&&((S=b.get(C))==null||S(i[0],y)),(P=k.get(C))==null||P(i[0],y)),d=C||null}),{registerObject:o,deregisterObject:c}};function Ae(e){let a=0;return e.traverse(t=>{if(t.isMesh&&t.geometry){const r=t.geometry,n=r.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,s=r.index?r.index.count*Uint32Array.BYTES_PER_ELEMENT:0,c=r.attributes.normal?r.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,o=r.attributes.uv?r.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,u=n+s+c+o;a+=u}}),a}const V=l.ref({}),z=e=>Object.assign(V.value,e);function ne({scene:e,canvas:a,windowSize:t,disableRender:r,rendererOptions:n}){const s=l.computed(()=>v.toValue(t)?v.useWindowSize():v.useElementSize(v.toValue(a).parentElement)),c=l.shallowRef({width:0,height:0}),o=v.refDebounced(c,10),u=l.watchEffect(()=>{c.value={width:s.value.width.value,height:s.value.height.value}}),f=l.computed(()=>o.value.width/o.value.height),m={height:l.computed(()=>o.value.height),width:l.computed(()=>o.value.width),aspectRatio:f},d=l.shallowRef(e),{camera:i,cameras:y,registerCamera:C,deregisterCamera:p,setCameraActive:b}=G({sizes:m,scene:e}),{renderer:k}=Q({scene:e,canvas:a,options:n,contextParts:{sizes:m,camera:i},disableRender:r}),_={sizes:m,scene:d,camera:i,cameras:l.readonly(y),renderer:k,raycaster:l.shallowRef(new M.Raycaster),controls:l.ref(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},extend:z,registerCamera:C,setCameraActive:b,deregisterCamera:p};l.provide("useTres",_);const D=100,S=v.useFps({every:D}),{isSupported:P,memory:j}=v.useMemory({interval:D}),h=160;let A=performance.now();const xe=({timestamp:F})=>{_.scene.value&&(_.perf.memory.allocatedMem=Ae(_.scene.value)),F-A>=D&&(A=F,_.perf.fps.accumulator.push(S.value),_.perf.fps.accumulator.length>h&&_.perf.fps.accumulator.shift(),_.perf.fps.value=S.value,P.value&&j.value&&(_.perf.memory.accumulator.push(j.value.usedJSHeapSize/1024/1024),_.perf.memory.accumulator.length>h&&_.perf.memory.accumulator.shift(),_.perf.memory.currentMem=_.perf.memory.accumulator.reduce((ze,Fe)=>ze+Fe,0)/_.perf.memory.accumulator.length))};let I=0;const Te=1,{pause:Ve,resume:it}=v.useRafFn(({delta:F})=>{window.__TRES__DEVTOOLS__&&(xe({timestamp:performance.now()}),I+=F,I>=Te&&(window.__TRES__DEVTOOLS__.cb(_),I=0))},{immediate:!0});return l.onUnmounted(()=>{u(),Ve()}),_}function ae(){const e=l.inject("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}const De=ae;function st(e){}let g=null;const{logError:se}=L(),N=["onClick","onPointerMove","onPointerEnter","onPointerLeave"],Se={createElement(e,a,t,r){var c,o;if(r||(r={}),r.args||(r.args=[]),e==="template"||ve(e))return null;let n=e.replace("Tres",""),s;if(e==="primitive"){(r==null?void 0:r.object)===void 0&&se("Tres primitives need a prop 'object'");const u=r.object;n=u.type,s=Object.assign(u,{type:n,attach:r.attach,primitive:!0})}else{const u=V.value[n];u||se(`${n} is not defined on the THREE namespace. Use extend to add it to the catalog.`),s=new u(...r.args)}return s.isCamera&&(r!=null&&r.position||s.position.set(3,3,3),r!=null&&r.lookAt||s.lookAt(0,0,0)),(r==null?void 0:r.attach)===void 0&&(s.isMaterial?s.attach="material":s.isBufferGeometry&&(s.attach="geometry")),s.isObject3D&&((c=r==null?void 0:r.material)!=null&&c.isMaterial&&(s.userData.tres__materialViaProp=!0),(o=r==null?void 0:r.geometry)!=null&&o.isBufferGeometry&&(s.userData.tres__geometryViaProp=!0)),s.userData={...s.userData,tres__name:n},s},insert(e,a){var r,n,s,c;a&&a.isScene&&(g=a);const t=a||g;if(e!=null&&e.isObject3D){if(e!=null&&e.isCamera){if(!(g!=null&&g.userData.tres__registerCamera))throw"could not find tres__registerCamera on scene's userData";(n=g==null?void 0:(r=g.userData).tres__registerCamera)==null||n.call(r,e)}if(e&&N.some(o=>e[o])){if(!(g!=null&&g.userData.tres__registerAtPointerEventHandler))throw"could not find tres__registerAtPointerEventHandler on scene's userData";(c=g==null?void 0:(s=g.userData).tres__registerAtPointerEventHandler)==null||c.call(s,e)}}e!=null&&e.isObject3D&&(t!=null&&t.isObject3D)?(t.add(e),e.dispatchEvent({type:"added"})):e!=null&&e.isFog?t.fog=e:typeof(e==null?void 0:e.attach)=="string"&&(e.__previousAttach=e[t==null?void 0:t.attach],t&&(t[e.attach]=e))},remove(e){var a,t;if(e){if(e.isObject3D){const r=e,n=f=>{var d,i;const m=f;f.userData.tres__materialViaProp||((d=m.material)==null||d.dispose(),m.material=void 0),f.userData.tres__geometryViaProp||((i=m.geometry)==null||i.dispose(),m.geometry=void 0)},s=g==null?void 0:g.userData.tres__deregisterAtPointerEventHandler,c=g==null?void 0:g.userData.tres__deregisterBlockingObjectAtPointerEventHandler,o=f=>{var m,d;if(!c)throw"could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData";if((d=g==null?void 0:(m=g.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||d.call(m,f),!s)throw"could not find tres__deregisterAtPointerEventHandler on scene's userData";f&&N.some(i=>f[i])&&(s==null||s(f))},u=f=>{const m=g==null?void 0:g.userData.tres__deregisterCamera;if(!m)throw"could not find tres__deregisterCamera on scene's userData";f.isCamera&&(m==null||m(f))};(a=e.removeFromParent)==null||a.call(e),r.traverse(f=>{n(f),u(f),o==null||o(f)}),n(r),u(r),o==null||o(r)}(t=e.dispose)==null||t.call(e)}},patchProp(e,a,t,r){var n,s,c,o;if(e){let u=e,f=a;if(e.isObject3D&&f==="blocks-pointer-events"){r||r===""?(s=g==null?void 0:(n=g.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||s.call(n,e):(o=g==null?void 0:(c=g.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||o.call(c,e);return}let m=x(f),d=u==null?void 0:u[m];if(f==="args"){const y=e,C=t??[],p=r??[],b=e.userData.tres__name||e.type;b&&C.length&&!we(C,p)&&(u=Object.assign(y,new V.value[b](...r)));return}if(u.type==="BufferGeometry"){if(f==="args")return;u.setAttribute(x(f),new M.BufferAttribute(...r));return}if(f.includes("-")&&d===void 0){const y=f.split("-");d=y.reduce((C,p)=>C[x(p)],u),f=y.pop(),m=f.toLowerCase(),d!=null&&d.set||(u=y.reduce((C,p)=>C[x(p)],u))}let i=r;if(i===""&&(i=!0),Z(d)){N.includes(a)||(Array.isArray(i)?e[m](...i):e[m](i));return}!(d!=null&&d.set)&&!Z(d)?u[m]=i:d.constructor===i.constructor&&(d!=null&&d.copy)?d==null||d.copy(i):Array.isArray(i)?d.set(...i):!d.isColor&&d.setScalar?d.setScalar(i):d.set(i)}},parentNode(e){return(e==null?void 0:e.parent)||null},createText:()=>void 0,createComment:()=>void 0,setText:()=>void 0,setElementText:()=>void 0,nextSibling:()=>void 0,querySelector:()=>void 0,setScopeId:()=>void 0,cloneNode:()=>void 0,insertStaticContent:()=>void 0},{render:je}=l.createRenderer(Se);z(le);const Le=["data-scene","data-tres"],oe=l.defineComponent({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(e,{expose:a}){var C;const t=e,{logWarning:r}=L(),n=l.ref(),s=l.shallowRef(new M.Scene),{resume:c}=$(),o=l.useSlots(),u=(C=l.getCurrentInstance())==null?void 0:C.appContext.app,f=p=>l.defineComponent({setup(){var k;const b=(k=l.getCurrentInstance())==null?void 0:k.appContext;return b&&(b.app=u),l.provide("useTres",p),l.provide("extend",z),()=>l.h(l.Fragment,null,o!=null&&o.default?o.default():[])}}),m=p=>{const b=f(p);je(l.h(b),s.value)},d=(p,b=!1)=>{s.value.children=[],b&&(p.renderer.value.dispose(),p.renderer.value.renderLists.dispose(),p.renderer.value.forceContextLoss()),m(p),c()},i=l.computed(()=>t.disableRender),y=l.shallowRef(null);return a({context:y,dispose:()=>d(y.value,!0)}),l.onMounted(()=>{const p=n;y.value=ne({scene:s.value,canvas:p,windowSize:t.windowSize,disableRender:i,rendererOptions:t}),re({scene:s.value,contextParts:y.value});const{registerCamera:b,camera:k,cameras:_,deregisterCamera:D}=y.value;m(y.value);const S=()=>{const P=new M.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3);P.position.set(3,3,3),P.lookAt(0,0,0),b(P);const j=l.watchEffect(()=>{_.value.length>=2&&(P.removeFromParent(),D(P),j==null||j())})};l.watch(()=>t.camera,(P,j)=>{P&&b(P),j&&(j.removeFromParent(),D(j))},{immediate:!0}),k.value||(r("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),S())}),(p,b)=>(l.openBlock(),l.createElementBlock("canvas",{ref_key:"canvas",ref:n,"data-scene":s.value.uuid,class:l.normalizeClass(p.$attrs.class),"data-tres":`tresjs ${l.unref(ue).version}`,style:l.normalizeStyle({display:"block",width:"100%",height:"100%",position:p.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...p.$attrs.style})},null,14,Le))}}),Ee=["TresCanvas","TresLeches","TresScene"],Oe={template:{compilerOptions:{isCustomElement:e=>e.startsWith("Tres")&&!Ee.includes(e)||e==="primitive"}}},Be={install(e){e.component("TresCanvas",oe)}};w.TresCanvas=oe,w.catalogue=V,w.default=Be,w.extend=z,w.isProd=pe,w.normalizeColor=Y,w.normalizeVectorFlexibleParam=me,w.templateCompilerOptions=Oe,w.trasverseObjects=ee,w.useCamera=G,w.useLoader=Me,w.useLogger=L,w.usePointerEventHandler=re,w.useRaycaster=te,w.useRenderLoop=$,w.useRenderer=Q,w.useSeek=ke,w.useTexture=Pe,w.useTres=De,w.useTresContext=ae,w.useTresContextProvider=ne,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
